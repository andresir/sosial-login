<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <link rel="shortcut icon" href="%PUBLIC_URL%/favicon.ico">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="theme-color" content="#000000">
    
    <!-- GOOGLE SIGIN ------------------------------------------------>
    <meta name="google-signin-client_id" content="276344702459-vu7siilinj6f7meti2lr8bjo2k99lrca.apps.googleusercontent.com">
    <script src="https://apis.google.com/js/client:platform.js?onload=renderButton" async defer></script>
    <!-- END GOOGLE SIGIN ------------------------------------------------>

    <!--  LINKEDIN SIGNIN ------------------------------------------------->
    <script type="text/javascript" src="http://platform.linkedin.com/in.js">
      api_key: "81hi1kfv7jh1sw"
      IN.User.authorize(callbackFunction, callbackScope);
    </script>
    
    <script type="text/javascript">
      function onLinkedInLoad() {
        IN.UI.Authorize().place();      
        IN.Event.on(IN, "auth", function () { onLogin(); });
        IN.Event.on(IN, "logout", function () { onLogout(); });
      }
      function onLogin() {
        IN.API.Profile("me").result(displayResult);
      }  
      function displayResult(profiles) {
        member = profiles.values[0];
        alert(member.id + " Hello " +  member.firstName + " " + member.lastName);
      }  
    </script>
    <!--  END LINKEDIN SIGNIN ------------------------------------------------->

    <link rel="manifest" href="%PUBLIC_URL%/manifest.json">
    <title>React App</title>
  </head>
  <body>
    <noscript>
      You need to enable JavaScript to run this app.
    </noscript>
    <div id="root"></div>
    <!-- GOOGLE SIGIN ------------------------------------------------>
    <div id="gSignIn"></div>
    <div class="userContent" style="display: none;"></div>
    <script>
      function renderButton() {
        gapi.signin2.render('gSignIn', {
          'scope': 'profile email',
          'width': 240,
          'height': 50,
          'longtitle': true,
          'theme': 'dark',
          'onsuccess': onSuccess,
          'onfailure': onFailure
        });
      }
      function onSuccess(googleUser) {
        let id_token = googleUser.getAuthResponse().id_token;  
        console.log(`ini token google`,id_token);
        gapi.client.load('oauth2', 'v2', function () {
          var request = gapi.client.oauth2.userinfo.get({
              'userId': 'me'
          });
          request.execute(function (resp) {
              var profileHTML = '<h3>Welcome '+resp.given_name+'! <a href="javascript:void(0);" onclick="signOut();">Sign out</a></h3>';
              profileHTML += '<img src="'+resp.picture+'"/><p><b>Google ID: </b>'+resp.id+'</p><p><b>Name: </b>'+resp.name+'</p><p><b>Email: </b>'+resp.email+'</p><p><b>Gender: </b>'+resp.gender+'</p><p><b>Locale: </b>'+resp.locale+'</p><p><b>Google Profile:</b> <a target="_blank" href="'+resp.link+'">click to view profile</a></p>';
              document.getElementsByClassName("userContent")[0].innerHTML = profileHTML;
              
              document.getElementById("gSignIn").style.display = "none";
              document.getElementsByClassName("userContent")[0].style.display = "block";
          });
        });
      }
      function onFailure(error) {
        alert(error);
      }
      function signOut() {
        var auth2 = gapi.auth2.getAuthInstance();
        auth2.signOut().then(function () {
          document.getElementsByClassName("userContent")[0].innerHTML = '';
          document.getElementsByClassName("userContent")[0].style.display = "none";
          document.getElementById("gSignIn").style.display = "block";
        });
        auth2.disconnect();
      }
      </script>
      <!-- END GOOGLE SIGIN --------------------------------------------------------->
  </body>
</html>
